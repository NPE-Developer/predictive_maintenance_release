"use strict";(self.webpackChunknagamas_frontend=self.webpackChunknagamas_frontend||[]).push([[132],{2087:(e,t,a)=>{a.d(t,{A:()=>o});var r=a(1121),n=a(9223),s=a.n(n);const o=class{static export(e,t,a){const r=new(s().Workbook),n=r.addWorksheet(e),o=e=>e>=0&&e<=51?["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","AA","AB","AC","AD","AE","AF","AG","AH","AI","AJ","AK","AL","AM","AN","AO","AP","AQ","AR","AS","AT","AU","AV","AW","AX","AY","AZ"][e]:"Invalid number";t.map((e,t)=>{n.getColumn(`${o(t)}`).width=20,n.getCell(`${o(t)}1`).value=String(e.toUpperCase()),n.getCell(`${o(t)}1`).style={fill:{type:"pattern",pattern:"solid",fgColor:{argb:"c8c8c8"}},font:{bold:!0},alignment:{vertical:"middle",horizontal:"center"},border:{top:{style:"thin",color:{argb:"000000"}},left:{style:"thin",color:{argb:"000000"}},right:{style:"thin",color:{argb:"000000"}},bottom:{style:"thin",color:{argb:"000000"}}}}}),a.map((e,a)=>{const r=[];t.map(t=>{null!=e[t]?r.push(e[t]):r.push("")});n.addRow(r).eachCell(e=>{e.style={alignment:{vertical:"middle",horizontal:"center"},border:{top:{style:"thin",color:{argb:"000000"}},left:{style:"thin",color:{argb:"000000"}},right:{style:"thin",color:{argb:"000000"}},bottom:{style:"thin",color:{argb:"000000"}}}}})}),r.xlsx.writeBuffer().then(t=>{const a=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),r=document.createElement("a");r.href=window.URL.createObjectURL(a),r.download=`${e}.xlsx`,r.click(),window.URL.revokeObjectURL(r.href)})}static async import(e){const t=new(s().Workbook);await t.xlsx.load(e);const a=[];if(t.eachSheet(e=>{const t=[];e.eachRow(e=>{t.push(e.values)}),a.push(t)}),a.length>0){const e=a[0],t=[];for(let a=1;a<e.length;a++){const s={};for(let t=0;t<e[a].length;t++){var n;if(null!=e[0][t]&&"string"==typeof e[0][t])if(e[a][t]instanceof Date)s[e[0][t].toLowerCase()]=(0,r.GP)(e[a][t],"yyyy-MM-dd HH:mm:ss");else s[e[0][t].toLowerCase()]="object"==typeof e[a][t]?e[a][t].result:null!==(n=e[a][t])&&void 0!==n?n:""}t.push(s)}return t}return[]}}},5175:(e,t,a)=>{a.d(t,{I:()=>s,r:()=>o});var r=a(8443),n=a(2340);class s{static async GetDashboardLevel1(e,t){const a=await n.A.fetchAuth(`${r.C}/api/v1/dashboard/l1?start_date=${encodeURIComponent(e)}&end_date=${encodeURIComponent(t)}`);if(200!==a.status)throw new Error("Failed to fetch dashboard data.");const s=[];for(let r=0;r<a.data.length;r++){const e=a.data[r];if(!Array.isArray(e.machine_ool_pressure))throw new Error("invalid ool pressure data");if(!Array.isArray(e.machine_ool_vibration))throw new Error("invalid ool vibration data");s.push({business_unit_id:e.business_unit_id,business_unit:e.business_unit,business_unit_warn:e.business_unit_warn,business_unit_alarm:e.business_unit_alarm,ool_pressure:e.ool_pressure,ool_vibration:e.ool_vibration,ool_temperature:e.ool_temperature,machine_ool_pressure:e.machine_ool_pressure,machine_ool_vibration:e.machine_ool_vibration,sensor_vibration_connected:e.sensor_vibration_connected,sensor_vibration_total:e.sensor_vibration_total,sensor_pressure_connected:e.sensor_pressure_connected,sensor_pressure_total:e.sensor_pressure_total})}return s}static async GetDashboardLevel2(e,t,a){const s=await n.A.fetchAuth(`${r.C}/api/v1/dashboard/l2?business_unit_id=${encodeURIComponent(e)}&start_date=${encodeURIComponent(t)}&end_date=${encodeURIComponent(a)}`);if(200!==s.status)throw new Error("Failed to fetch dashboard data.");const o=[];for(let r=0;r<s.data.length;r++){const e=s.data[r];if(!Array.isArray(e.machine_ool_pressure))throw new Error("invalid ool pressure data");if(!Array.isArray(e.machine_ool_vibration))throw new Error("invalid ool vibration data");o.push({link_up_id:e.link_up_id,link_up:e.link_up,link_up_warn:e.link_up_warn,link_up_alarm:e.link_up_alarm,ool_pressure:e.ool_pressure,ool_vibration:e.ool_vibration,ool_temperature:e.ool_temperature,machine_ool_pressure:e.machine_ool_pressure,machine_ool_vibration:e.machine_ool_vibration,sensor_vibration_connected:e.sensor_vibration_connected,sensor_vibration_total:e.sensor_vibration_total,sensor_pressure_connected:e.sensor_pressure_connected,sensor_pressure_total:e.sensor_pressure_total})}return o}static async GetDashboardLevel3(e,t,a){const s=await n.A.fetchAuth(`${r.C}/api/v1/dashboard/l3?link_up_id=${encodeURIComponent(e)}&start_date=${encodeURIComponent(t)}&end_date=${encodeURIComponent(a)}`);if(200!==s.status)throw new Error("Failed to fetch dashboard data.");const o=[];for(let r=0;r<s.data.length;r++){const e=s.data[r];o.push({machine_id:e.machine_id,machine:e.machine,machine_warn:e.machine_warn,machine_alarm:e.machine_alarm,machine_type:e.machine_type,ool_pressure:e.ool_pressure,ool_vibration:e.ool_vibration,ool_temperature:e.ool_temperature,sensor_vibration_connected:e.sensor_vibration_connected,sensor_pressure_connected:e.sensor_pressure_connected})}return o}static async GetDashboardLevel4Pressure(e,t,a){let s=await n.A.fetchAuth(`${r.C}/api/v1/dashboard/pressure/l4?machine_id=${encodeURIComponent(e)}&start_date=${encodeURIComponent(t)}&end_date=${encodeURIComponent(a)}`);if(200!==s.status)throw new Error(s.message);const o=Array.isArray(s.data)?s.data:[],l=[];for(let r=0;r<o.length;r++)l.push({pressure:o[r].pressure,pressure_max_alarm:o[r].pressure_max_alarm,pressure_max_warn:o[r].pressure_max_warn,pressure_min_alarm:o[r].pressure_min_alarm,pressure_min_warn:o[r].pressure_min_warn,timestamp:o[r].timestamp});return l}static async GetDashboardLevel4Vibration(e,t,a){let s=await n.A.fetchAuth(`${r.C}/api/v1/dashboard/vibration/l4?machine_id=${encodeURIComponent(e)}&start_date=${encodeURIComponent(t)}&end_date=${encodeURIComponent(a)}`);if(200!==s.status)throw new Error(s.message);const o=Array.isArray(s.data)?s.data:[],l=[];for(let r=0;r<o.length;r++)l.push({x:o[r].x,x_base:o[r].x_base,x_warn:o[r].x_warn,x_alarm:o[r].x_alarm,z:o[r].z,z_base:o[r].z_base,z_warn:o[r].z_warn,z_alarm:o[r].z_alarm,x_acc:o[r].x_acc,x_acc_base:o[r].x_acc_base,x_acc_warn:o[r].x_acc_warn,x_acc_alarm:o[r].x_acc_alarm,z_acc:o[r].z_acc,z_acc_base:o[r].z_acc_base,z_acc_warn:o[r].z_acc_warn,z_acc_alarm:o[r].z_acc_alarm,temp:o[r].temp,temp_warn:o[r].temp_warn,temp_alarm:o[r].temp_alarm,timestamp:o[r].timestamp});return l}}class o{static async GetDashboardLevel1(){const e=await n.A.fetchAuth(`${r.C}/api/v1/dashboard/realtime/l1`);if(200!==e.status)throw new Error("Failed to fetch dashboard data.");const t=[];for(let a=0;a<e.data.length;a++){const r=e.data[a];if(!Array.isArray(r.machine_ool_pressure))throw new Error("invalid ool pressure data");if(!Array.isArray(r.machine_ool_vibration))throw new Error("invalid ool vibration data");const n=r.machine_ool_pressure.concat(r.machine_ool_vibration);Array.from(new Set(n));t.push({business_unit_id:r.business_unit_id,business_unit:r.business_unit,business_unit_warn:r.business_unit_warn,business_unit_alarm:r.business_unit_alarm,ool_pressure:r.ool_pressure,ool_vibration:r.ool_vibration,ool_temperature:r.ool_temperature,machine_ool_pressure:r.machine_ool_pressure,machine_ool_vibration:r.machine_ool_vibration,sensor_vibration_connected:r.sensor_vibration_connected,sensor_vibration_total:r.sensor_vibration_total,sensor_pressure_connected:r.sensor_pressure_connected,sensor_pressure_total:r.sensor_pressure_total})}return t}static async GetDashboardLevel2(e){const t=await n.A.fetchAuth(`${r.C}/api/v1/dashboard/realtime/l2?business_unit_id=${encodeURIComponent(e)}`);if(200!==t.status)throw new Error("Failed to fetch dashboard data.");const a=[];for(let r=0;r<t.data.length;r++){const e=t.data[r];if(!Array.isArray(e.machine_ool_pressure))throw new Error("invalid ool pressure data");if(!Array.isArray(e.machine_ool_vibration))throw new Error("invalid ool vibration data");a.push({link_up_id:e.link_up_id,link_up:e.link_up,link_up_warn:e.link_up_warn,link_up_alarm:e.link_up_alarm,ool_pressure:e.ool_pressure,ool_vibration:e.ool_vibration,ool_temperature:e.ool_temperature,machine_ool_pressure:e.machine_ool_pressure,machine_ool_vibration:e.machine_ool_vibration,sensor_vibration_connected:e.sensor_vibration_connected,sensor_vibration_total:e.sensor_vibration_total,sensor_pressure_connected:e.sensor_pressure_connected,sensor_pressure_total:e.sensor_pressure_total})}return a}static async GetDashboardLevel3(e){const t=await n.A.fetchAuth(`${r.C}/api/v1/dashboard/realtime/l3?link_up_id=${encodeURIComponent(e)}`);if(200!==t.status)throw new Error("Failed to fetch dashboard data.");const a=[];for(let r=0;r<t.data.length;r++){const e=t.data[r];a.push({machine_id:e.machine_id,machine:e.machine,machine_type:e.machine_type,ool_pressure:e.ool_pressure,ool_vibration:e.ool_vibration,ool_temperature:e.ool_temperature,machine_warn:e.machine_warn,machine_alarm:e.machine_alarm,sensor_vibration_connected:e.sensor_vibration_connected,sensor_pressure_connected:e.sensor_pressure_connected})}return a}}},5764:(e,t,a)=>{a.d(t,{A:()=>n});class r{}r.FilterTable=(e,t)=>{let a=Object.keys(e);for(let r=0;r<a.length;r++){const n=a[r];if(t[n]){if(void 0==e||null==e[n])return!1;if(""!==t[n]&&0==e[n].toString().toLowerCase().includes(t[n].toString().toLowerCase()))return!1}}return!0},r.SortingTable=(e,t,a)=>{if(null!=a&&void 0!=a&&void 0!==e[a]&&void 0!==t[a]){if("string"===typeof e[a]&&"string"===typeof t[a])return e[a].localeCompare(t[a]);if("number"===typeof e[a]&&"number"===typeof t[a])return e[a]-t[a]}return 0},r.FastIsEmpty=e=>{for(const t in e)return!1;return!0};const n=r},6132:(e,t,a)=>{a.r(t),a.d(t,{default:()=>A});var r=a(5043),n=a(8270),s=a(1121),o=a(2573),l=a(5764),i=a(414),c=a(184),d=a(5175),_=a(3216),u=a(6278),m=a(2620),h=a(397),p=a(8443),b=a(6361),x=a(2926),y=a(6058),f=a(2087),v=a(579);b.t1.register(b.No,b.FN,b.kc,b.hE,b.PP,b.m_,b.s$),x.d.maintainAspectRatio=!1,x.d.responsive=!0;const w=["x","x_acc","z","z_acc","temp"],g={x:"X Axis",x_acc:"X Acceleration",z:"Z Axis",z_acc:"Z Acceleration",temp:"Temperature"},A=e=>{let{realtime:t,setRealtime:a,refresh:b,start_date:x,end_date:A,setHandleGenerateExcel:j}=e;const k=(0,r.useContext)(o.A),z=(k.contextAccessToken,k.contextShowAlertFunc),C=k.contextShowLoadingFunc,{machineId:$}=(k.stateShowLoading,(0,_.g)()),M="#fb8500",S="rgba(41, 191, 18, 0.21)",N="rgba(244, 188, 20, 0.28)",R="rgba(213, 14, 81, 0.2)",[F,I]=(0,r.useState)(new Date),[D,E]=(0,r.useState)(!0),[H,P]=(0,r.useState)("minutes_10"),[T,B]=(0,r.useState)("chart"),[G,U]=(0,r.useState)("x"),[V,L]=(0,r.useState)(null),[W,O]=(0,r.useState)("ascending"),[Z,X]=(0,r.useState)([]),[Y,J]=(0,r.useState)([]),q=(0,r.useRef)({}),[K,Q]=(0,r.useState)({}),[ee,te]=(0,r.useState)({labels:[],datasets:[]}),[ae,re]=(0,r.useState)({}),ne=(0,r.useRef)(null);let se=null,oe=!0;const[le,ie]=(0,r.useState)([]),[ce,de]=(0,r.useState)([]),[_e,ue]=(0,r.useState)({}),[me,he]=(0,r.useState)({labels:[],datasets:[]}),[pe,be]=(0,r.useState)({}),xe=(0,r.useRef)(null),ye=[{key:"timestamp",label:"Waktu"},{key:"x",label:"X"},{key:"x_base",label:"X Base"},{key:"x_warn",label:"X Warn"},{key:"x_alarm",label:"X Alarm"},{key:"z",label:"Z"},{key:"z_base",label:"Z Base"},{key:"z_warn",label:"Z Warn"},{key:"z_alarm",label:"Z Alarm"},{key:"x_acc",label:"X Acc"},{key:"x_acc_base",label:"X Acc Base"},{key:"x_acc_warn",label:"X Acc Warn"},{key:"x_acc_alarm",label:"X Acc Alarm"},{key:"z_acc",label:"Z Acc"},{key:"z_acc_base",label:"Z Acc Base"},{key:"z_acc_warn",label:"Z Acc Warn"},{key:"z_acc_alarm",label:"Z Acc Alarm"},{key:"temp",label:"Temp"},{key:"temp_warn",label:"Temp Warn"},{key:"temp_alarm",label:"Temp Alarm"}];function fe(e){const t={};return"all"==H?{all:[...e].toReversed()}:(e.toReversed().forEach(e=>{const a=new Date(e.timestamp),r=new Date(a);r.setMinutes(10*Math.floor(a.getMinutes()/10)),r.setSeconds(0),r.setMilliseconds(0);let n=(0,s.GP)(r,"yyyy-MM-dd HH:00:00");switch(H){case"hour":n=(0,s.GP)(r,"yyyy-MM-dd HH:00:00");break;case"minutes_10":n=(0,s.GP)(r,"yyyy-MM-dd HH:mm:00")}void 0==t[n]?t[n]=[]:t[n].push(e)}),t)}function ve(e,a,r){var n;const o=e,l=`${Math.floor(r.getMinutes()/10)}0`;let i=(0,s.GP)(r,"yyyy-MM-dd HH:00:00");switch(H){case"hour":i=(0,s.GP)(r,"yyyy-MM-dd HH:00:00");break;case"minutes_10":i=(0,s.GP)(r,`yyyy-MM-dd HH:${l}:00`);break;case"all":i="all"}const c=null!==(n=o[i])&&void 0!==n?n:[],d=c.map(e=>(0,s.Yq)(e.timestamp,"all"==i?"MM-dd HH:mm":"HH:mm:ss")),_=c.map(e=>e[a]);var u,m,h,p;c.toReversed()[0]&&(t?xe.current={alarm:null!==(u=c[0][`${a}_alarm`])&&void 0!==u?u:0,warn:null!==(m=c[0][`${a}_warn`])&&void 0!==m?m:0}:ne.current={alarm:null!==(h=c[0][`${a}_alarm`])&&void 0!==h?h:0,warn:null!==(p=c[0][`${a}_warn`])&&void 0!==p?p:0});const b=Math.min(..._),x=Math.max(..._),y=x-b||1;return{chartData:{labels:d,datasets:[{label:`${g[a]}`,data:_,borderColor:M,pointBackgroundColor:M,pointBorderColor:"#ffffff",pointHoverBackgroundColor:"#ffffff",pointHoverBorderColor:M,borderWidth:4,pointRadius:0}]},customMin:b-.2*y,customMax:x+.2*y}}const we={id:"statusArea",beforeDatasetsDraw(e){const t=ne.current,{ctx:a,chartArea:r,scales:n}=e;if(!r||!n.x||!n.y)return;if(!t||(0===t.warn||null==t.warn)&&(0===t.alarm||null==t.alarm))return;a.save();const s=n.y.min,o=t?t.warn:0,l=n.y.getPixelForValue(s),i=n.y.getPixelForValue(o);a.fillStyle=S,a.fillRect(r.left,Math.min(l,i),r.right-r.left,Math.abs(l-i));const c=t?t.warn:0,d=t?t.alarm:0,_=n.y.getPixelForValue(c),u=n.y.getPixelForValue(d);a.fillStyle=N,a.fillRect(r.left,Math.min(_,u),r.right-r.left,Math.abs(_-u));const m=t?t.alarm:0,h=n.y.max,p=n.y.getPixelForValue(m),b=n.y.getPixelForValue(h);a.fillStyle=R,a.fillRect(r.left,Math.min(p,b),r.right-r.left,Math.abs(p-b)),a.restore()}},ge=(e,t,a)=>{const{chartData:r,customMin:n,customMax:s}=ve(e,t,a);te(r),re({responsive:!0,maintainAspectRatio:!1,animation:{duration:800,easing:"easeInOutCubic"},plugins:{legend:{position:"top",labels:{color:"#fbeecc",font:{size:14,weight:500,family:"'Inter', 'Segoe UI', sans-serif"},usePointStyle:!0,pointStyle:"rectRounded"}},tooltip:{backgroundColor:"#1f2937",titleColor:"#f8fafc",bodyColor:"#cbd5e1",padding:12,borderColor:"#0077b6",borderWidth:1,cornerRadius:8,titleFont:{family:"'Inter', sans-serif",size:14,weight:600},bodyFont:{family:"'Inter', sans-serif",size:13}}},scales:{x:{grid:{color:"#0d2b35"},ticks:{color:"#fbeecc",font:{size:12,family:"'Inter', sans-serif"},maxRotation:45,minRotation:0}},y:{grid:{color:"#0d2b35"},ticks:{color:"#fbeecc",font:{size:12,family:"'Inter', sans-serif"},padding:8},min:n,max:s}},layout:{padding:{top:10,bottom:10,left:10,right:10}},elements:{line:{borderJoinStyle:"round"},point:{pointStyle:"circle"}}})},Ae=(e,t)=>{var a;return(0,v.jsx)("div",{children:(0,v.jsx)("input",{style:{fontSize:"12px",marginTop:"0.5dvh",width:"150px"},type:"text",value:null!==(a=K[e])&&void 0!==a?a:"",placeholder:`${null!==t&&void 0!==t?t:e} ...`,onChange:t=>{Q(a=>{const r={...a};return r[e]=t.target.value,r})}})})},je=(e,t)=>{const a=ke(t.x,t.x_warn,t.x_alarm),r=ke(t.x_acc,t.x_acc_warn,t.x_acc_alarm),n=ke(t.z,t.z_warn,t.z_alarm),o=ke(t.z_acc,t.z_acc_warn,t.z_acc_alarm),l=ke(t.temp,t.temp_warn,t.temp_alarm);return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("td",{children:e+1}),(0,v.jsx)("td",{children:(0,s.GP)(t.timestamp,"yyyy-MM-dd HH:mm:ss")}),(0,v.jsx)("td",{style:{color:a.color,fontWeight:a.weight},children:t.x}),(0,v.jsx)("td",{children:t.x_base}),(0,v.jsx)("td",{children:t.x_warn}),(0,v.jsx)("td",{children:t.x_alarm}),(0,v.jsx)("td",{style:{color:n.color,fontWeight:n.weight},children:t.z}),(0,v.jsx)("td",{children:t.z_base}),(0,v.jsx)("td",{children:t.z_warn}),(0,v.jsx)("td",{children:t.z_alarm}),(0,v.jsx)("td",{style:{color:r.color,fontWeight:r.weight},children:t.x_acc}),(0,v.jsx)("td",{children:t.x_acc_base}),(0,v.jsx)("td",{children:t.x_acc_warn}),(0,v.jsx)("td",{children:t.x_acc_alarm}),(0,v.jsx)("td",{style:{color:o.color,fontWeight:o.weight},children:t.z_acc}),(0,v.jsx)("td",{children:t.z_acc_base}),(0,v.jsx)("td",{children:t.z_acc_warn}),(0,v.jsx)("td",{children:t.z_acc_alarm}),(0,v.jsx)("td",{style:{color:l.color,fontWeight:l.weight},children:t.temp}),(0,v.jsx)("td",{children:t.temp_warn}),(0,v.jsx)("td",{children:t.temp_alarm})]})},ke=(e,t,a)=>{let r="black",n="400";return void 0!=t&&e<t&&(r="green",n="bold"),void 0!=t&&e>=t&&(r="orange",n="bold"),void 0!=a&&e>=a&&(r="red",n="bold"),{color:r,weight:n}};(0,r.useEffect)(()=>{(()=>{const e=Y.filter(e=>l.A.FilterTable(e,K)).sort((e,t)=>V?"ascending"==W?l.A.SortingTable(e,t,V):l.A.SortingTable(t,e,V):0);X(e)})()},[K,V,W]),(0,r.useEffect)(()=>{(async e=>{e&&C(!0);try{const e=await d.I.GetDashboardLevel4Vibration(Number($),(0,s.Yq)(x,"yyyy-MM-dd"),(0,s.Yq)(A,"yyyy-MM-dd"));X(e),J(e);const t=fe(e);q.current=t;const a=Object.keys(t);if(a.length>0&&"all"!=H){const e=new Date(a[a.length-1]);I(e),ge(q.current,G,e)}else ge(q.current,G,F)}catch(t){z(new i.u({message:t instanceof Error?t.message:t.toString(),level:3}))}finally{C(!1)}})(0!=b)},[b]);const ze={id:"statusAreaRealtime",beforeDatasetsDraw(e){const t=xe.current,{ctx:a,chartArea:r,scales:n}=e;if(!r||!n.x||!n.y)return;if(!t||(0===t.warn||null==t.warn)&&(0===t.alarm||null==t.alarm))return;a.save();const s=n.y.min,o=t?t.warn:0,l=n.y.getPixelForValue(s),i=n.y.getPixelForValue(o);a.fillStyle=S,a.fillRect(r.left,Math.min(l,i),r.right-r.left,Math.abs(l-i));const c=t?t.warn:0,d=t?t.alarm:0,_=n.y.getPixelForValue(c),u=n.y.getPixelForValue(d);a.fillStyle=N,a.fillRect(r.left,Math.min(_,u),r.right-r.left,Math.abs(_-u));const m=t?t.alarm:0,h=n.y.max,p=n.y.getPixelForValue(m),b=n.y.getPixelForValue(h);a.fillStyle=R,a.fillRect(r.left,Math.min(p,b),r.right-r.left,Math.abs(p-b)),a.restore()}},Ce=(e,t,a)=>{const{chartData:r,customMin:n,customMax:s}=ve(e,t,a);he(r),be({responsive:!0,maintainAspectRatio:!1,animation:{duration:800,easing:"easeInOutCubic"},plugins:{legend:{position:"top",labels:{color:"#fbeecc",font:{size:14,weight:500,family:"'Inter', 'Segoe UI', sans-serif"},usePointStyle:!0,pointStyle:"rectRounded"}},tooltip:{backgroundColor:"#1f2937",titleColor:"#f8fafc",bodyColor:"#cbd5e1",padding:12,borderColor:"#0077b6",borderWidth:1,cornerRadius:8,titleFont:{family:"'Inter', sans-serif",size:14,weight:600},bodyFont:{family:"'Inter', sans-serif",size:13}}},scales:{x:{grid:{color:"#0d2b35"},ticks:{color:"#fbeecc",font:{size:12,family:"'Inter', sans-serif"},maxRotation:45,minRotation:0}},y:{grid:{color:"#0d2b35"},ticks:{color:"#fbeecc",font:{size:12,family:"'Inter', sans-serif"},padding:8},min:n,max:s}},layout:{padding:{top:10,bottom:10,left:10,right:10}},elements:{line:{borderJoinStyle:"round"},point:{pointStyle:"circle"}}})},$e=(e,t)=>{var a;return(0,v.jsx)("div",{children:(0,v.jsx)("input",{style:{fontSize:"12px",marginTop:"0.5dvh",width:"150px"},type:"text",value:null!==(a=_e[e])&&void 0!==a?a:"",placeholder:`${null!==t&&void 0!==t?t:e} ...`,onChange:t=>{ue(a=>{const r={...a};return r[e]=t.target.value,r})}})})},Me=()=>{if(oe)return new Promise((e,t)=>{try{se=new WebSocket(`${p.C}/ws/realtime/vibration`),se.onmessage=e=>{try{const t=JSON.parse(e.data);ie(t.data),de(t.data)}catch(t){console.log("Invalid response: ",t.message)}},se.onerror=e=>{var t;console.error("WebSocket error:",e),null===(t=se)||void 0===t||t.close()},se.onclose=async()=>{console.log("vibrationSocket closed."),console.log("Try reconnecting...");try{await Me()}catch(e){console.log("Failed to reconnect")}},se.onopen=()=>{var t;console.log("vibrationSocket connected");const a={type:"subscribe",machine_id:$};null===(t=se)||void 0===t||t.send(JSON.stringify(a)),e(!0)}}catch(a){console.log("Error reconnect: ",a),t(!1)}});console.log("canceled")};(0,r.useEffect)(()=>(null!=se&&se.readyState!=WebSocket.CLOSED||(console.log("Connecting ws vibration..."),Me()),()=>{null!=se&&(console.log("Disconnecting ws vibration..."),se.close()),oe=!1}),[se]),(0,r.useEffect)(()=>{(()=>{const e=ce.filter(e=>l.A.FilterTable(e,_e)).sort((e,t)=>V?"ascending"==W?l.A.SortingTable(e,t,V):l.A.SortingTable(t,e,V):0);ie(e)})()},[_e,V,W]),(0,r.useEffect)(()=>{if(!t)return;if(!D)return;const e=fe(le),a=new Date;a.setMinutes(10*Math.floor(a.getMinutes()/10)),I(a),Ce(e,G,a)},[D,t,le,G,H]),(0,r.useEffect)(()=>{if(!t)return;if(D)return;const e=fe(le);Ce(e,G,F)},[D,t,le,G,F,H]),(0,r.useEffect)(()=>{t||ge(q.current,G,F)},[t,q.current,G,F]),(0,r.useEffect)(()=>{const e=fe(Z);q.current=e;const t=Object.keys(e);if("all"!=H&&t.length>0){const e=new Date(t[t.length-1]);I(e)}else I(new Date)},[t,H]);const Se=(0,r.useMemo)(()=>"all"==H?"All Data":"hour"==H?(0,s.Yq)(F,"dd MMM yyyy HH:00"):"minutes_10"==H?(0,s.Yq)(F,"dd MMM yyyy HH:mm"):void 0,[F,H]),Ne=(e,t)=>{E(!1);const a=new Date(F),r=10*Math.floor(a.getMinutes()/10);"hours"===t?a.setHours(a.getHours()+e,r,0,0):"minutes"===t&&a.setHours(a.getHours(),r+e,0,0),I(a)},Re=(e,t)=>{if(B(e),a(t),L(null),O("ascending"),"chart"==e)if(t){const e=fe(le);Ce(e,G,F)}else ge(q.current,G,F)},Fe=()=>{if(0==le.length)return z(new i.u({message:"NO DATA!",level:3}));let e=[];for(let i=0;i<Z.length;i++){var t,a,r,n,o,l,c,d,_,u;const m=Z[i];e.push({timestamp:(0,s.GP)("string"===typeof m.timestamp?new Date(m.timestamp):m.timestamp,"yyyy-MM-dd HH:mm:ss"),x:`${m.x}`,x_base:`${m.x_base}`,x_warn:`${null!==(t=m.x_warn)&&void 0!==t?t:""}`,x_alarm:`${null!==(a=m.x_alarm)&&void 0!==a?a:""}`,z:`${m.z}`,z_base:`${m.z_base}`,z_warn:`${null!==(r=m.z_warn)&&void 0!==r?r:""}`,z_alarm:`${null!==(n=m.z_alarm)&&void 0!==n?n:""}`,x_acc:`${m.x_acc}`,x_acc_base:`${m.x_acc_base}`,x_acc_warn:`${null!==(o=m.x_acc_warn)&&void 0!==o?o:""}`,x_acc_alarm:`${null!==(l=m.x_acc_alarm)&&void 0!==l?l:""}`,z_acc:`${m.z_acc}`,z_acc_base:`${m.z_acc_base}`,z_acc_warn:`${null!==(c=m.z_acc_warn)&&void 0!==c?c:""}`,z_acc_alarm:`${null!==(d=m.z_acc_alarm)&&void 0!==d?d:""}`,temp:`${m.temp}`,temp_warn:`${null!==(_=m.temp_warn)&&void 0!==_?_:""}`,temp_alarm:`${null!==(u=m.temp_alarm)&&void 0!==u?u:""}`})}f.A.export("Vibration Data Realtime",["timestamp","x","x_base","x_warn","x_alarm","z","z_base","z_warn","z_alarm","x_acc","x_acc_base","x_acc_warn","x_acc_alarm","z_acc","z_acc_base","z_acc_warn","z_acc_alarm","temp","temp_warn","temp_alarm"],e)},Ie=()=>{if(0===Z.length)return z(new i.u({message:"NO DATA!",level:3}));let e=[];for(let i=0;i<Z.length;i++){var t,a,r,n,o,l,c,d,_,u;const m=Z[i];e.push({timestamp:(0,s.GP)("string"===typeof m.timestamp?new Date(m.timestamp):m.timestamp,"yyyy-MM-dd HH:mm:ss"),x:`${m.x}`,x_base:`${m.x_base}`,x_warn:`${null!==(t=m.x_warn)&&void 0!==t?t:""}`,x_alarm:`${null!==(a=m.x_alarm)&&void 0!==a?a:""}`,z:`${m.z}`,z_base:`${m.z_base}`,z_warn:`${null!==(r=m.z_warn)&&void 0!==r?r:""}`,z_alarm:`${null!==(n=m.z_alarm)&&void 0!==n?n:""}`,x_acc:`${m.x_acc}`,x_acc_base:`${m.x_acc_base}`,x_acc_warn:`${null!==(o=m.x_acc_warn)&&void 0!==o?o:""}`,x_acc_alarm:`${null!==(l=m.x_acc_alarm)&&void 0!==l?l:""}`,z_acc:`${m.z_acc}`,z_acc_base:`${m.z_acc_base}`,z_acc_warn:`${null!==(c=m.z_acc_warn)&&void 0!==c?c:""}`,z_acc_alarm:`${null!==(d=m.z_acc_alarm)&&void 0!==d?d:""}`,temp:`${m.temp}`,temp_warn:`${null!==(_=m.temp_warn)&&void 0!==_?_:""}`,temp_alarm:`${null!==(u=m.temp_alarm)&&void 0!==u?u:""}`})}f.A.export("Vibration Data",["timestamp","x","x_base","x_warn","x_alarm","z","z_base","z_warn","z_alarm","x_acc","x_acc_base","x_acc_warn","x_acc_alarm","z_acc","z_acc_base","z_acc_warn","z_acc_alarm","temp","temp_warn","temp_alarm"],e)};return(0,r.useEffect)(()=>(j(t?()=>Fe:()=>Ie),()=>{j(null)}),[t,le,Z]),(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:n.A.cardBodyHeader,children:["chart"===T&&t&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:n.A.headerChart,children:[(0,v.jsx)("div",{className:n.A.chartButtons,children:w.map(e=>(0,v.jsx)("button",{onClick:()=>U(e),className:G===e?n.A.activeBtn:"",children:g[e]},e))}),(0,v.jsx)("div",{className:n.A.titleChart,children:Se}),(0,v.jsxs)("div",{className:n.A.chartButtons,style:{justifyContent:"end"},children:[(0,v.jsx)("button",{onClick:()=>P("hour"),className:"hour"===H?n.A.activeBtn:"",children:"Hour"}),(0,v.jsx)("button",{onClick:()=>P("minutes_10"),className:"minutes_10"===H?n.A.activeBtn:"",children:"Minute"}),(0,v.jsx)("button",{onClick:()=>P("all"),className:"all"===H?n.A.activeBtn:"",children:"All"})]})]}),(0,v.jsxs)("div",{className:n.A.bodyChart,children:[(0,v.jsx)("button",{className:n.A.buttonChart1,style:{borderRadius:"0 0 0 12px"},onClick:()=>{"hour"==H?Ne(-1,"hours"):"minutes_10"==H&&Ne(-10,"minutes")},children:(0,v.jsx)(c.ed2,{})}),(0,v.jsx)("div",{className:n.A.wrapperChart,children:(0,v.jsx)(y.N1,{data:me,options:pe,plugins:[ze]})}),(0,v.jsx)("button",{className:n.A.buttonChart2,style:{borderRadius:"0 0 12px 0"},onClick:()=>{"hour"==H?Ne(1,"hours"):"minutes_10"==H&&Ne(10,"minutes")},children:(0,v.jsx)(c.FDZ,{})})]})]}),"table"===T&&t&&(0,v.jsx)(v.Fragment,{children:(0,v.jsx)("div",{style:{flex:1,overflowY:"auto"},className:"ordering-table",children:(0,v.jsxs)("table",{className:"tableclickcell",children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{children:"No"}),ye.map(e=>{return(0,v.jsxs)("th",{className:"timestamp"===e.key?"wide-timestamp":"",children:[(t=e.key,a=e.label,(0,v.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",gap:"3px",whiteSpace:"nowrap",cursor:"pointer"},onClick:()=>{L(t),O("ascending"===W?"descending":"ascending")},children:[(0,v.jsx)("div",{children:null!==a&&void 0!==a?a:t}),(0,v.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0",alignItems:"center",justifyItems:"center"},children:[(0,v.jsx)(c.XhJ,{style:{color:V==t&&"descending"==W?"var(--secondary-color)":"silver",margin:0,padding:0,height:"18px"}}),(0,v.jsx)(c.GOR,{style:{color:V==t&&"ascending"==W?"var(--secondary-color)":"silver",margin:"-18px",padding:0,height:"18px"}})]})]})),$e(e.key,e.label)]},e.key);var t,a})]})}),l.A.FastIsEmpty(le)?(0,v.jsx)("tbody",{children:(0,v.jsx)("tr",{children:(0,v.jsx)("td",{colSpan:1e3,children:"No Data Available Yet !"})})}):(0,v.jsx)("tbody",{children:(0,v.jsx)(u.A,{tableData:le,rowFunction:je,rowsCount:250,rowsIncrement:50})})]})})}),"chart"===T&&!t&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)("div",{className:n.A.headerChart,children:[(0,v.jsx)("div",{className:n.A.chartButtons,children:w.map(e=>(0,v.jsx)("button",{onClick:()=>{U(e)},className:G===e?n.A.activeBtn:"",children:g[e]},e))}),(0,v.jsx)("div",{className:n.A.titleChart,children:Se}),(0,v.jsxs)("div",{className:n.A.chartButtons,style:{justifyContent:"end"},children:[(0,v.jsx)("button",{onClick:()=>P("hour"),className:"hour"===H?n.A.activeBtn:"",children:"Hour"}),(0,v.jsx)("button",{onClick:()=>P("minutes_10"),className:"minutes_10"===H?n.A.activeBtn:"",children:"Minute"}),(0,v.jsx)("button",{onClick:()=>P("all"),className:"all"===H?n.A.activeBtn:"",children:"All"})]})]}),(0,v.jsxs)("div",{className:n.A.bodyChart,children:[(0,v.jsx)("button",{className:n.A.buttonChart1,style:{borderRadius:"0 0 0 12px"},onClick:()=>{"hour"==H?Ne(-1,"hours"):"minutes_10"==H&&Ne(-10,"minutes")},children:(0,v.jsx)(c.ed2,{})}),(0,v.jsx)("div",{className:n.A.wrapperChart,children:(0,v.jsx)(y.N1,{data:ee,options:ae,plugins:[we]})}),(0,v.jsx)("button",{className:n.A.buttonChart2,style:{borderRadius:"0 0 12px 0"},onClick:()=>{"hour"==H?Ne(1,"hours"):"minutes_10"==H&&Ne(10,"minutes")},children:(0,v.jsx)(c.FDZ,{})})]})]}),"table"===T&&!t&&(0,v.jsx)(v.Fragment,{children:(0,v.jsx)("div",{style:{flex:1,overflowY:"auto"},className:"ordering-table",children:(0,v.jsxs)("table",{className:"tableclickcell",children:[(0,v.jsx)("thead",{children:(0,v.jsxs)("tr",{children:[(0,v.jsx)("th",{children:"No"}),ye.map(e=>{return(0,v.jsxs)("th",{className:"timestamp"===e.key?"wide-timestamp":"",children:[(t=e.key,a=e.label,(0,v.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",gap:"3px",whiteSpace:"nowrap",cursor:"pointer"},onClick:()=>{L(t),O("ascending"===W?"descending":"ascending")},children:[(0,v.jsx)("div",{children:null!==a&&void 0!==a?a:t}),(0,v.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0",alignItems:"center",justifyItems:"center"},children:[(0,v.jsx)(c.XhJ,{style:{color:V==t&&"descending"==W?"var(--secondary-color)":"silver",margin:0,padding:0,height:"18px"}}),(0,v.jsx)(c.GOR,{style:{color:V==t&&"ascending"==W?"var(--secondary-color)":"silver",margin:"-18px",padding:0,height:"18px"}})]})]})),Ae(e.key,e.label)]},e.key);var t,a})]})}),l.A.FastIsEmpty(Z)?(0,v.jsx)("tbody",{children:(0,v.jsx)("tr",{children:(0,v.jsx)("td",{colSpan:1e3,children:"No Data Available Yet !"})})}):(0,v.jsx)("tbody",{children:(0,v.jsx)(u.A,{tableData:Z,rowFunction:je,rowsCount:250,rowsIncrement:50})})]})})})]}),(0,v.jsxs)("div",{className:n.A.cardBodyFooter,children:[(0,v.jsxs)("div",{className:n.A.footerLeft,children:[(0,v.jsxs)("button",{className:`${n.A.buttonFooter} ${"chart"===T&&t?n.A.active:""}`,onClick:()=>{Re("chart",!0)},children:[(0,v.jsx)(m.kk8,{}),(0,v.jsx)("span",{className:n.A.tooltipText,children:"Realtime Chart"})]}),(0,v.jsxs)("button",{className:`${n.A.buttonFooter} ${"table"===T&&t?n.A.active:""}`,onClick:()=>{Re("table",!0)},children:[(0,v.jsx)(h.ZIs,{}),(0,v.jsx)("span",{className:n.A.tooltipText,children:"Realtime Table"})]})]}),(0,v.jsx)("div",{className:n.A.footerMid,children:"chart"===T&&t&&(0,v.jsxs)("div",{className:n.A.switchGroup,children:[(0,v.jsx)("label",{htmlFor:"auto",children:"Auto"}),(0,v.jsxs)("label",{className:n.A.switch,children:[(0,v.jsx)("input",{type:"checkbox",id:"auto",checked:D,onChange:()=>{E(e=>!e)}}),(0,v.jsx)("span",{className:n.A.slider})]})]})}),(0,v.jsxs)("div",{className:n.A.footerRight,children:[(0,v.jsxs)("button",{className:`${n.A.buttonFooter} ${"chart"!==T||t?"":n.A.active}`,onClick:()=>{Re("chart",!1)},children:[(0,v.jsx)(c.YYR,{}),(0,v.jsx)("span",{className:n.A.tooltipText,children:"Chart"})]}),(0,v.jsxs)("button",{className:`${n.A.buttonFooter} ${"table"!==T||t?"":n.A.active}`,onClick:()=>{Re("table",!1)},children:[(0,v.jsx)(c.ist,{}),(0,v.jsx)("span",{className:n.A.tooltipText,children:"Table"})]})]})]})]})}},6278:(e,t,a)=>{a.d(t,{A:()=>l});var r=a(5043),n=a(5843),s=a(579);function o(e){const{onVisible:t,content:a}=e,{ref:r}=(0,n.Wx)({threshold:.1,triggerOnce:!1,initialInView:!1,onChange:(e,a)=>{e&&t()}});return(0,s.jsx)("tr",{ref:r,children:a})}function l(e){const{tableData:t,rowFunction:a,onRowClick:n,rowsCount:l,rowsIncrement:i}=e,c=l,d=i,[_,u]=(0,r.useState)(c),m=(0,r.useMemo)(()=>{const e=[];for(let r=0;r<t.length;r++){if(r<_-c||r>_)continue;const l=t[r];e.push((0,s.jsxs)(s.Fragment,{children:[r==_?(0,s.jsx)(o,{content:(0,s.jsx)(s.Fragment,{}),onVisible:function(){u(e=>e+d),setTimeout(()=>{var e;null===(e=document.getElementById(`rows_${r}`))||void 0===e||e.scrollIntoView()})}}):(0,s.jsx)(s.Fragment,{}),r==_-c&&0!=r?(0,s.jsx)(o,{content:(0,s.jsx)(s.Fragment,{}),onVisible:function(){u(e=>e-d<c?c:e-d),setTimeout(()=>{var e;null===(e=document.getElementById(`rows_${r}`))||void 0===e||e.scrollIntoView()})}}):(0,s.jsx)(s.Fragment,{}),(0,s.jsx)("tr",{id:`rows_${r}`,style:{whiteSpace:"nowrap"},onClick:()=>{null!=n&&n(l)},children:a(r,l)}),r==t.length-1?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:1e3,children:"END OF DATA"})}):(0,s.jsx)(s.Fragment,{})]}))}return e},[_,t]);return(0,r.useEffect)(()=>{u(c)},[t]),m.map(e=>e)}}}]);
//# sourceMappingURL=132.445b5256.chunk.js.map